<!-- Code Generated by Sidekick is for learning and experimentation purposes only. -->
<!DOCTYPE html>
<html>
<head>
  <title>Management Team</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 40px; }
    .hidden { display: none; }
    label { display: block; margin-top: 10px; }
    input[type="text"], input[type="password"] { width: 200px; }
    button { margin-top: 10px; }
    ul { margin-top: 10px; }
    #commonPlayerDisplay { color:#ffe082; font-weight:bold; margin-bottom:8px; }
    #commonPlayerModal {
      display: none; position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
      background: rgba(0,0,0,0.5); align-items: center; justify-content: center; z-index: 1000;
    }
    #commonPlayerModalContent {
      background: #fff; padding: 20px; border-radius: 8px; min-width: 300px;
    }
  </style>
</head>
<body>
  <h2>Management Team</h2>

  <!-- Login Form -->
  <div id="loginDiv">
    <label>Username: <input type="text" id="username"></label>
    <label>Password: <input type="password" id="password"></label>
    <button onclick="checkLogin()">Login</button>
    <div id="loginError" style="color:red"></div>
  </div>

  <!-- Captain Selection and Player Auction -->
  <div id="managementDiv" class="hidden">
    <h3>Enter Captains</h3>
    <label>Team A Captain: <input type="text" id="captainA"></label>
    <label>Team B Captain: <input type="text" id="captainB"></label>
    <button onclick="saveCaptains()">Save Captains</button>
    <div id="captainMsg" style="color:green"></div>

    <div id="commonPlayerDisplay"></div>

    <h3>Add Players for Auction</h3>
    <label>Player Name: <input type="text" id="playerName"></label>
    <label>Role: <input type="text" id="playerRole" placeholder="e.g. Batsman"></label>
    <button onclick="addPlayer()">Add Player</button>
    <div id="playerMsg" style="color:green"></div>
    <ul id="playerList"></ul>

    <button onclick="finalizeAuctionList()">Save and Go to Auction</button>
    <div id="finalizeMsg" style="color:blue"></div>
  </div>

  <!-- Common Player Modal -->
  <div id="commonPlayerModal">
    <div id="commonPlayerModalContent">
      <h4>Select Common Player</h4>
      <select id="commonPlayerSelect"></select>
      <br>
      <button onclick="confirmCommonPlayer()">Confirm</button>
      <button onclick="modalHide()">Cancel</button>
    </div>
  </div>

<script>
// Code Generated by Sidekick is for learning and experimentation purposes only.

let setupPlayers = [];
let commonPlayer = null;

// Dummy login for demonstration
function checkLogin() {
  const user = document.getElementById('username').value.trim();
  const pass = document.getElementById('password').value.trim();
  if (user && pass) {
    document.getElementById('loginDiv').style.display = "none";
    document.getElementById('managementDiv').style.display = "block";
  } else {
    document.getElementById('loginError').textContent = "Enter username and password.";
  }
}

// Save captains (optional message)
function saveCaptains() {
  const a = document.getElementById('captainA').value.trim();
  const b = document.getElementById('captainB').value.trim();
  if (!a || !b) {
    document.getElementById('captainMsg').textContent = "Enter both captain names.";
    return;
  }
  document.getElementById('captainMsg').textContent = "Captains saved!";
}

// Add player to list
function addPlayer() {
  const name = document.getElementById('playerName').value.trim();
  const role = document.getElementById('playerRole').value.trim();
  if (!name || !role) {
    document.getElementById('playerMsg').textContent = "Enter both name and role.";
    return;
  }
  setupPlayers.push({ name, role });
  document.getElementById('playerName').value = '';
  document.getElementById('playerRole').value = '';
  document.getElementById('playerMsg').textContent = "Player added!";
  updatePlayerList();
}

// Update player list display
function updatePlayerList() {
  const ul = document.getElementById('playerList');
  ul.innerHTML = '';
  setupPlayers.forEach((p, i) => {
    const li = document.createElement('li');
    li.textContent = `${p.name} (${p.role})`;
    const removeBtn = document.createElement('button');
    removeBtn.textContent = "Remove";
    removeBtn.style.marginLeft = "10px";
    removeBtn.onclick = function() {
      setupPlayers.splice(i, 1);
      updatePlayerList();
      updateCommonPlayerDisplay();
    };
    li.appendChild(removeBtn);
    ul.appendChild(li);
  });
  updateCommonPlayerDisplay();
}

// Show common player modal if needed
function finalizeAuctionList() {
  const captainA = document.getElementById('captainA').value.trim();
  const captainB = document.getElementById('captainB').value.trim();
  if (!captainA || !captainB) {
    document.getElementById('finalizeMsg').textContent = "Enter both captain names.";
    return;
  }
  if (setupPlayers.length < 2) {
    document.getElementById('finalizeMsg').textContent = "Add at least 2 players.";
    return;
  }
  if (setupPlayers.length % 2 === 1 && !commonPlayer) {
    showCommonPlayerModal();
    return;
  }
  saveSetupAndGoToAuction(captainA, captainB, commonPlayer);
}

// Modal logic
function showCommonPlayerModal() {
  const modal = document.getElementById('commonPlayerModal');
  const select = document.getElementById('commonPlayerSelect');
  select.innerHTML = setupPlayers.map(
    (p, i) => `<option value="${i}">${p.name} (${p.role})</option>`
  ).join('');
  modal.style.display = "flex";
}

function confirmCommonPlayer() {
  const idx = document.getElementById('commonPlayerSelect').value;
  if (idx === "" || idx === undefined) return;
  commonPlayer = setupPlayers.splice(idx, 1)[0]; // Remove from list!
  modalHide();
  updatePlayerList();
  updateCommonPlayerDisplay();
  // Now, after selecting, proceed to auction automatically
  const captainA = document.getElementById('captainA').value.trim();
  const captainB = document.getElementById('captainB').value.trim();
  saveSetupAndGoToAuction(captainA, captainB, commonPlayer);
}

function modalHide() {
  document.getElementById('commonPlayerModal').style.display = "none";
}

// Save all to localStorage and go to auction
function saveSetupAndGoToAuction(captainA, captainB, commonPlayer) {
  localStorage.setItem('captainA', captainA);
  localStorage.setItem('captainB', captainB);
  localStorage.setItem('auctionPlayers', JSON.stringify(setupPlayers));
  if (commonPlayer) {
    localStorage.setItem('commonPlayer', JSON.stringify(commonPlayer));
  } else {
    localStorage.removeItem('commonPlayer');
  }
  // Redirect automatically
  window.location.href = "index.html";
}

// Show common player below list if present
function updateCommonPlayerDisplay() {
  const div = document.getElementById('commonPlayerDisplay');
  if (commonPlayer) {
    div.textContent = `Common Player: ${commonPlayer.name} (${commonPlayer.role})`;
    div.style.display = "block";
  } else if (localStorage.getItem('commonPlayer')) {
    // If page reloaded and commonPlayer not in RAM, show from storage
    const cp = JSON.parse(localStorage.getItem('commonPlayer'));
    div.textContent = `Common Player: ${cp.name} (${cp.role})`;
    div.style.display = "block";
  } else {
    div.textContent = "";
    div.style.display = "none";
  }
}

// On page load, show any existing players and common player
window.onload = function() {
  updatePlayerList();
  updateCommonPlayerDisplay();
};

</script>
</body>
</html>
